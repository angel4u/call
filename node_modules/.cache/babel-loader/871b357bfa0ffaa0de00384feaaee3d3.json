{"ast":null,"code":"/**\n * Exception class.\n * @class\n * @name Exception\n * @exports Exception as Twilio.Exception\n * @memberOf Twilio\n * @param {string} message The exception message\n */\nfunction TwilioException(message) {\n  if (!(this instanceof TwilioException)) {\n    return new TwilioException(message);\n  }\n\n  this.message = message;\n}\n/**\n * Returns the exception message.\n *\n * @return {string} The exception message.\n */\n\n\nTwilioException.prototype.toString = function () {\n  return \"Twilio.Exception: \" + this.message;\n};\n\nfunction average(values) {\n  return values && values.length ? values.reduce(function (t, v) {\n    return t + v;\n  }) / values.length : 0;\n}\n\nfunction difference(lefts, rights, getKey) {\n  getKey = getKey || function (a) {\n    return a;\n  };\n\n  var rightKeys = new Set(rights.map(getKey));\n  return lefts.filter(function (left) {\n    return !rightKeys.has(getKey(left));\n  });\n}\n\nfunction isElectron(navigator) {\n  return !!navigator.userAgent.match('Electron');\n}\n\nfunction isChrome(window, navigator) {\n  var isCriOS = !!navigator.userAgent.match('CriOS');\n  var isHeadlessChrome = !!navigator.userAgent.match('HeadlessChrome');\n  var isGoogle = typeof window.chrome !== 'undefined' && navigator.vendor === 'Google Inc.' && navigator.userAgent.indexOf('OPR') === -1 && navigator.userAgent.indexOf('Edge') === -1;\n  return isCriOS || isElectron(navigator) || isGoogle || isHeadlessChrome;\n}\n\nfunction isFirefox(navigator) {\n  navigator = navigator || (typeof window === 'undefined' ? global.navigator : window.navigator);\n  return !!navigator && typeof navigator.userAgent === 'string' && /firefox|fxios/i.test(navigator.userAgent);\n}\n\nfunction isLegacyEdge(navigator) {\n  navigator = navigator || (typeof window === 'undefined' ? global.navigator : window.navigator);\n  return !!navigator && typeof navigator.userAgent === 'string' && /edge\\/\\d+/i.test(navigator.userAgent);\n}\n\nfunction isSafari(navigator) {\n  return !!navigator.vendor && navigator.vendor.indexOf('Apple') !== -1 && navigator.userAgent && navigator.userAgent.indexOf('CriOS') === -1 && navigator.userAgent.indexOf('FxiOS') === -1;\n}\n\nfunction isUnifiedPlanDefault(window, navigator, PeerConnection, RtpTransceiver) {\n  if (typeof window === 'undefined' || typeof navigator === 'undefined' || typeof PeerConnection === 'undefined' || typeof RtpTransceiver === 'undefined' || typeof PeerConnection.prototype === 'undefined' || typeof RtpTransceiver.prototype === 'undefined') {\n    return false;\n  }\n\n  if (isChrome(window, navigator) && PeerConnection.prototype.addTransceiver) {\n    var pc = new PeerConnection();\n    var isUnifiedPlan = true;\n\n    try {\n      pc.addTransceiver('audio');\n    } catch (e) {\n      isUnifiedPlan = false;\n    }\n\n    pc.close();\n    return isUnifiedPlan;\n  } else if (isFirefox(navigator)) {\n    return true;\n  } else if (isSafari(navigator)) {\n    return 'currentDirection' in RtpTransceiver.prototype;\n  } // Edge currently does not support unified plan.\n  // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/17733189/\n  // https://wpdev.uservoice.com/forums/257854-microsoft-edge-developer/suggestions/34451998-sdp-unified-plan\n\n\n  return false;\n}\n\nfunction queryToJson(params) {\n  if (!params) {\n    return '';\n  }\n\n  return params.split('&').reduce(function (output, pair) {\n    var parts = pair.split('=');\n    var key = parts[0];\n    var value = decodeURIComponent((parts[1] || '').replace(/\\+/g, '%20'));\n\n    if (key) {\n      output[key] = value;\n    }\n\n    return output;\n  }, {});\n}\n/**\n * Map a list to an array of arrays, and return the flattened result.\n * @param {Array<*>|Set<*>|Map<*>} list\n * @param {function(*): Array<*>} [mapFn]\n * @returns Array<*>\n */\n\n\nfunction flatMap(list, mapFn) {\n  var listArray = list instanceof Map || list instanceof Set ? Array.from(list.values()) : list;\n\n  mapFn = mapFn || function (item) {\n    return item;\n  };\n\n  return listArray.reduce(function (flattened, item) {\n    var mapped = mapFn(item);\n    return flattened.concat(mapped);\n  }, []);\n}\n\nexports.Exception = TwilioException;\nexports.average = average;\nexports.difference = difference;\nexports.isElectron = isElectron;\nexports.isChrome = isChrome;\nexports.isFirefox = isFirefox;\nexports.isLegacyEdge = isLegacyEdge;\nexports.isSafari = isSafari;\nexports.isUnifiedPlanDefault = isUnifiedPlanDefault;\nexports.queryToJson = queryToJson;\nexports.flatMap = flatMap;","map":{"version":3,"sources":["../../lib/twilio/util.js"],"names":[],"mappings":"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","sourcesContent":["/**\n * Exception class.\n * @class\n * @name Exception\n * @exports Exception as Twilio.Exception\n * @memberOf Twilio\n * @param {string} message The exception message\n */\nfunction TwilioException(message) {\n  if (!(this instanceof TwilioException)) {\n    return new TwilioException(message);\n  }\n  this.message = message;\n}\n\n/**\n * Returns the exception message.\n *\n * @return {string} The exception message.\n */\nTwilioException.prototype.toString = function() {\n  return `Twilio.Exception: ${this.message}`;\n};\n\nfunction average(values) {\n  return values && values.length ? values.reduce((t, v) => t + v) / values.length : 0;\n}\n\nfunction difference(lefts, rights, getKey) {\n  getKey = getKey || (a => a);\n  const rightKeys = new Set(rights.map(getKey));\n  return lefts.filter(left => !rightKeys.has(getKey(left)));\n}\n\nfunction isElectron(navigator) {\n  return !!navigator.userAgent.match('Electron');\n}\n\nfunction isChrome(window, navigator) {\n  const isCriOS = !!navigator.userAgent.match('CriOS');\n  const isHeadlessChrome = !!navigator.userAgent.match('HeadlessChrome');\n  const isGoogle = typeof window.chrome !== 'undefined'\n    && navigator.vendor === 'Google Inc.'\n    && navigator.userAgent.indexOf('OPR') === -1\n    && navigator.userAgent.indexOf('Edge') === -1;\n\n  return isCriOS || isElectron(navigator) || isGoogle || isHeadlessChrome;\n}\n\nfunction isFirefox(navigator) {\n  navigator = navigator || (typeof window === 'undefined'\n    ? global.navigator : window.navigator);\n\n  return !!(navigator) && typeof navigator.userAgent === 'string'\n    && /firefox|fxios/i.test(navigator.userAgent);\n}\n\nfunction isLegacyEdge(navigator) {\n  navigator = navigator || (typeof window === 'undefined'\n    ? global.navigator : window.navigator);\n\n  return !!(navigator) && typeof navigator.userAgent === 'string'\n    && /edge\\/\\d+/i.test(navigator.userAgent);\n}\n\nfunction isSafari(navigator) {\n  return !!(navigator.vendor) && navigator.vendor.indexOf('Apple') !== -1\n    && navigator.userAgent\n    && navigator.userAgent.indexOf('CriOS') === -1\n    && navigator.userAgent.indexOf('FxiOS') === -1;\n}\n\nfunction isUnifiedPlanDefault(window, navigator, PeerConnection, RtpTransceiver) {\n  if (typeof window === 'undefined'\n    || typeof navigator === 'undefined'\n    || typeof PeerConnection === 'undefined'\n    || typeof RtpTransceiver === 'undefined'\n    || typeof PeerConnection.prototype === 'undefined'\n    || typeof RtpTransceiver.prototype === 'undefined') {\n    return false;\n  }\n\n  if (isChrome(window, navigator) && PeerConnection.prototype.addTransceiver) {\n    const pc = new PeerConnection();\n    let isUnifiedPlan = true;\n    try {\n      pc.addTransceiver('audio');\n    } catch (e) {\n      isUnifiedPlan = false;\n    }\n    pc.close();\n    return isUnifiedPlan;\n  } else if (isFirefox(navigator)) {\n    return true;\n  } else if (isSafari(navigator)) {\n    return 'currentDirection' in RtpTransceiver.prototype;\n  }\n\n  // Edge currently does not support unified plan.\n  // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/17733189/\n  // https://wpdev.uservoice.com/forums/257854-microsoft-edge-developer/suggestions/34451998-sdp-unified-plan\n\n  return false;\n}\n\nfunction queryToJson(params) {\n  if (!params) {\n    return '';\n  }\n\n  return params.split('&').reduce((output, pair) => {\n    const parts = pair.split('=');\n    const key = parts[0];\n    const value = decodeURIComponent((parts[1] || '').replace(/\\+/g, '%20'));\n\n    if (key) { output[key] = value; }\n    return output;\n  }, { });\n}\n\n/**\n * Map a list to an array of arrays, and return the flattened result.\n * @param {Array<*>|Set<*>|Map<*>} list\n * @param {function(*): Array<*>} [mapFn]\n * @returns Array<*>\n */\nfunction flatMap(list, mapFn) {\n  const listArray = list instanceof Map || list instanceof Set\n    ? Array.from(list.values())\n    : list;\n\n  mapFn = mapFn || (item => item);\n\n  return listArray.reduce((flattened, item) => {\n    const mapped = mapFn(item);\n    return flattened.concat(mapped);\n  }, []);\n}\n\nexports.Exception = TwilioException;\nexports.average = average;\nexports.difference = difference;\nexports.isElectron = isElectron;\nexports.isChrome = isChrome;\nexports.isFirefox = isFirefox;\nexports.isLegacyEdge = isLegacyEdge;\nexports.isSafari = isSafari;\nexports.isUnifiedPlanDefault = isUnifiedPlanDefault;\nexports.queryToJson = queryToJson;\nexports.flatMap = flatMap;\n"],"sourceRoot":""},"metadata":{},"sourceType":"script"}